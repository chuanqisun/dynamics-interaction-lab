(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{72:function(e,t,n){"use strict";n.r(t);var l,a,o=n(34),s=n(0),i=n(36),r=n(37),c=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},h={titleWidth:160,shellHeight:48,shellDividerSideMargin:8,shellDividerVerticalMargin:16,dividerStrokeWidth:1},u=function(e){function t(t){var n=e.call(this,t)||this;return n.updateDimensions=function(){n.reflowItems()},n.reflowItems=function(){for(var e,t,l={dynamicsDisplayStack:n.props.dynamicsDisplayStack.slice(),systemDisplayStack:n.props.systemDisplayStack.slice(),dynamicsOverflowStack:[],systemOverflowStack:[],customOverflowStack:n.props.customOverflowStack.slice()};n.canReduce(l)&&n.getRemainingSpace(l)<0;)l.dynamicsDisplayStack.length?(e=[l.dynamicsDisplayStack,[]],l.dynamicsOverflowStack=e[0],l.dynamicsDisplayStack=e[1]):(t=[l.systemDisplayStack,[]],l.systemOverflowStack=t[0],l.systemDisplayStack=t[1]);n.setState(l)},n.canReduce=function(e){return e.dynamicsDisplayStack.length+e.systemDisplayStack.length>0},n.editable=function(e){return e&&(e.contentEditable=!0)&&(e.spellcheck=!1)},n.getRemainingSpace=function(e){var t=h.shellHeight,n=h.titleWidth,l=h.shellHeight,a=h.shellHeight*e.dynamicsDisplayStack.length,o=1!==e.customOverflowStack.length||e.dynamicsOverflowStack.length||e.systemOverflowStack.length?0:h.shellHeight,s=e.customOverflowStack.length+e.dynamicsOverflowStack.length+e.systemOverflowStack.length>1?h.shellHeight:0,i=e.systemDisplayStack.length?2*h.shellDividerSideMargin+h.dividerStrokeWidth:0,r=h.shellHeight*e.systemDisplayStack.length,c=h.shellHeight;return window.innerWidth-(t+n+l+a+o+s+i+r+c)},n.getOverflowItems=function(e){return e.customOverflowStack.concat(e.dynamicsOverflowStack,e.systemOverflowStack)},n.toggleOverflowMenu=function(){n.setState({showOverflowMenu:!n.state.showOverflowMenu})},n.state={showOverflowMenu:!1,dynamicsDisplayStack:n.props.dynamicsDisplayStack.slice(),systemDisplayStack:n.props.systemDisplayStack.slice(),dynamicsOverflowStack:[],systemOverflowStack:[],customOverflowStack:n.props.customOverflowStack.slice()},n}return c(t,e),t.prototype.componentDidMount=function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateDimensions)},t.prototype.componentDidUpdate=function(e){e.customOverflowStack!==this.props.customOverflowStack&&this.updateDimensions()},t.prototype.render=function(){return s.createElement(p,null,s.createElement("button",{className:"shell-icon-button shell-icon-button--waffle"},r.a.WaffleOffice365),s.createElement("div",{className:"shell-title",ref:this.editable},"Sales"),s.createElement("button",{className:"shell-icon-button"},r.a.Search),this.state.dynamicsDisplayStack.map(function(e){return s.createElement("button",{key:e.label,className:"shell-icon-button"},e.icon)}),this.getOverflowItems(this.state).length>1?s.createElement("button",{onClick:this.toggleOverflowMenu,className:"shell-icon-button shell-icon-button--more"},r.a.More,this.state.showOverflowMenu?s.createElement("div",{className:"overflow-menu"},this.state.dynamicsOverflowStack.concat(this.state.customOverflowStack).map(function(e){return s.createElement("div",{key:e.label,className:"menu-row"},s.createElement("span",{className:"menu-row__icon"},e.icon),s.createElement("span",{className:"menu-row__text"},e.label))}),this.state.systemOverflowStack.length?s.createElement("div",{className:"menu-divider"}):null,this.state.systemOverflowStack.map(function(e){return s.createElement("div",{key:e.label,className:"menu-row"},s.createElement("span",{className:"menu-row__icon"},e.icon),s.createElement("span",{className:"menu-row__text"},e.label))})):null):this.getOverflowItems(this.state).length>0?s.createElement("button",{className:"shell-icon-button"},this.state.customOverflowStack[0].icon):null,this.state.systemDisplayStack.length?s.createElement("div",{className:"shell-divider"}):null,this.state.systemDisplayStack.map(function(e){return s.createElement("button",{key:e.label,className:"shell-icon-button"},e.icon)}),s.createElement("button",{className:"shell-icon-button shell-icon-button--avatar"},s.createElement("img",{className:"avatar",alt:"your avatar",src:this.props.avatarImgUrl})))},t}(s.Component),p=i.a.header(a||(a=m(["\n  color: white;\n  display: flex;\n  align-items: center;\n  height: ","px;\n  background-color: #002050;\n\n  .overflow-menu {\n    background-color: white;\n    color: black;\n    font-family: var(--ff-segoe-ui);\n    position: absolute;\n    top: ","px;\n    right: 0;\n    box-shadow: 0 3.2px 7.2px 0 rgba(0,0,0,.132), 0 0.6px 1.8px 0 rgba(0,0,0,.108);\n  }\n\n  .menu-row__text {\n    white-space: nowrap;\n  }\n\n  .menu-row {\n    display: flex;\n    margin: 16px 16px;\n    align-items: center;\n  }\n\n  .menu-row__icon {\n    font-family: var(--ff-mdl2);\n    flex: 0 0 16px;\n    margin-right: 16px;\n  }\n\n  .menu-divider {\n    height: 1px;\n    background-color: rgba(0,0,0,0.25);\n  }\n\n  .shell-divider {\n    align-self: stretch;\n    margin: ","px ","px;\n    width: ","px;\n    flex: 0 0 auto;\n    background-color: rgba(255,255,255,0.55);\n  }\n\n  .shell-title {\n    flex: 1 1 auto;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    font-weight: 600;\n  }\n\n  .shell-icon-button {\n    background-color: transparent;\n    flex: 0 0 auto;\n    color: white;\n    border: none;\n    font-size: 16px;\n    font-family: var(--ff-mdl2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: ","px;\n    width: ","px;\n  }\n\n  .shell-icon-button--avatar {\n    height: ","px;\n    width: ","px;\n    box-sizing: border-box;\n\n    .avatar {\n      border-radius: 50%;\n      height: calc(0.6*","px);\n      width: calc(0.6*","px);\n      box-sizing: border-box;\n    }\n  }\n\n  .shell-icon-button--more {\n    position: relative;\n  }\n"],["\n  color: white;\n  display: flex;\n  align-items: center;\n  height: ","px;\n  background-color: #002050;\n\n  .overflow-menu {\n    background-color: white;\n    color: black;\n    font-family: var(--ff-segoe-ui);\n    position: absolute;\n    top: ","px;\n    right: 0;\n    box-shadow: 0 3.2px 7.2px 0 rgba(0,0,0,.132), 0 0.6px 1.8px 0 rgba(0,0,0,.108);\n  }\n\n  .menu-row__text {\n    white-space: nowrap;\n  }\n\n  .menu-row {\n    display: flex;\n    margin: 16px 16px;\n    align-items: center;\n  }\n\n  .menu-row__icon {\n    font-family: var(--ff-mdl2);\n    flex: 0 0 16px;\n    margin-right: 16px;\n  }\n\n  .menu-divider {\n    height: 1px;\n    background-color: rgba(0,0,0,0.25);\n  }\n\n  .shell-divider {\n    align-self: stretch;\n    margin: ","px ","px;\n    width: ","px;\n    flex: 0 0 auto;\n    background-color: rgba(255,255,255,0.55);\n  }\n\n  .shell-title {\n    flex: 1 1 auto;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    font-weight: 600;\n  }\n\n  .shell-icon-button {\n    background-color: transparent;\n    flex: 0 0 auto;\n    color: white;\n    border: none;\n    font-size: 16px;\n    font-family: var(--ff-mdl2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: ","px;\n    width: ","px;\n  }\n\n  .shell-icon-button--avatar {\n    height: ","px;\n    width: ","px;\n    box-sizing: border-box;\n\n    .avatar {\n      border-radius: 50%;\n      height: calc(0.6*","px);\n      width: calc(0.6*","px);\n      box-sizing: border-box;\n    }\n  }\n\n  .shell-icon-button--more {\n    position: relative;\n  }\n"])),h.shellHeight,h.shellHeight,h.shellDividerVerticalMargin,h.shellDividerSideMargin,h.dividerStrokeWidth,h.shellHeight,h.shellHeight,h.shellHeight,h.shellHeight,h.shellHeight,h.shellHeight);n.d(t,"AppShellDemo",function(){return g});var f=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function l(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(l.prototype=n.prototype,new l)}}(),d=[{icon:r.a.TBX,label:"Task flow"},{icon:r.a.ToolTip,label:"Relationship Assistant"},{icon:r.a.Add,label:"Create"}],w=[{icon:r.a.Settings,label:"Settings"},{icon:r.a.Help,label:"Help"}],g=function(e){function t(t){var n=e.call(this,t)||this;return n.addCustomItem=function(){var e=n.state.customOverflowStack.concat([{icon:r.a.Emoji2,label:"Custom "+n.state.customOverflowStack.length}]);n.setState({customOverflowStack:e})},n.removeCustomItem=function(){var e=n.state.customOverflowStack.slice();e.pop(),n.setState({customOverflowStack:e})},n.state={customOverflowStack:[{icon:r.a.Emoji2,label:"Custom 0"}]},n}return f(t,e),t.prototype.render=function(){return o.createElement(o.Fragment,null,o.createElement("section",null,o.createElement("h2",{className:"lab-demo-h2"},"Sample"),o.createElement(u,{avatarImgUrl:"https://api.adorable.io/avatars/285/abott@adorable.png",dynamicsDisplayStack:d,systemDisplayStack:w,customOverflowStack:this.state.customOverflowStack})),o.createElement("section",null,o.createElement("h2",{className:"lab-demo-h2"},"Usage"),o.createElement("section",{style:{marginTop:"16px"}},o.createElement("span",null,"Custom actions: "),o.createElement("button",{onClick:this.removeCustomItem},"-"),o.createElement("span",null," ",this.state.customOverflowStack.length," "),o.createElement("button",{onClick:this.addCustomItem},"+")),o.createElement("section",null,o.createElement("h3",null,"Design notes"),o.createElement("ul",null,o.createElement("li",null,"This prototype only shows browser behavior. Shim experience is out of scope"),o.createElement("li",null,"When viewport narrows, Dynamics actions (task flow, relationship assistance, create) collapse first, then System buttons (help, settings) next"),o.createElement("li",null,"Custom actions are always collapsed except when there is only one"),o.createElement("li",null,"The System buttons are either all collapsed or all expanded"),o.createElement("li",null,"The Dynamics actions are either all collapsed or all expanded")))))},t}(o.Component);t.default=g}}]);