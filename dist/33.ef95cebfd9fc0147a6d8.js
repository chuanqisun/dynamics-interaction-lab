(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{49:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a,l,o=n(0),i=n(35),s=n(36),r=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},m={titleWidth:160,shellHeight:48,shellDividerSideMargin:8,shellDividerVerticalMargin:16,dividerStrokeWidth:1},p=function(e){function t(t){var n=e.call(this,t)||this;return n.updateDimensions=function(){n.reflowItems()},n.reflowItems=function(){for(var e,t,a={dynamicsDisplayStack:n.props.dynamicsDisplayStack.slice(),systemDisplayStack:n.props.systemDisplayStack.slice(),dynamicsOverflowStack:[],systemOverflowStack:[],customOverflowStack:n.props.customOverflowStack.slice()};n.canReduce(a)&&n.getRemainingSpace(a)<0;)a.dynamicsDisplayStack.length?(e=[a.dynamicsDisplayStack,[]],a.dynamicsOverflowStack=e[0],a.dynamicsDisplayStack=e[1]):(t=[a.systemDisplayStack,[]],a.systemOverflowStack=t[0],a.systemDisplayStack=t[1]);n.setState(a)},n.canReduce=function(e){return e.dynamicsDisplayStack.length+e.systemDisplayStack.length>0},n.editable=function(e){return e&&(e.contentEditable=!0)&&(e.spellcheck=!1)},n.getRemainingSpace=function(e){var t=m.shellHeight,n=m.titleWidth,a=m.shellHeight,l=m.shellHeight*e.dynamicsDisplayStack.length,o=1!==e.customOverflowStack.length||e.dynamicsOverflowStack.length||e.systemOverflowStack.length?0:m.shellHeight,i=e.customOverflowStack.length+e.dynamicsOverflowStack.length+e.systemOverflowStack.length>1?m.shellHeight:0,s=e.systemDisplayStack.length?2*m.shellDividerSideMargin+m.dividerStrokeWidth:0,r=m.shellHeight*e.systemDisplayStack.length,c=m.shellHeight;return window.innerWidth-(t+n+a+l+o+i+s+r+c)},n.getOverflowItems=function(e){return e.customOverflowStack.concat(e.dynamicsOverflowStack,e.systemOverflowStack)},n.toggleOverflowMenu=function(){n.setState({showOverflowMenu:!n.state.showOverflowMenu})},n.state={showOverflowMenu:!1,dynamicsDisplayStack:n.props.dynamicsDisplayStack.slice(),systemDisplayStack:n.props.systemDisplayStack.slice(),dynamicsOverflowStack:[],systemOverflowStack:[],customOverflowStack:n.props.customOverflowStack.slice()},n}return r(t,e),t.prototype.componentDidMount=function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateDimensions)},t.prototype.componentDidUpdate=function(e){e.customOverflowStack!==this.props.customOverflowStack&&this.updateDimensions()},t.prototype.render=function(){return o.createElement(u,null,o.createElement("button",{className:"shell-icon-button shell-icon-button--waffle"},s.a.WaffleOffice365),o.createElement("div",{className:"shell-title",ref:this.editable},"Sales"),o.createElement("button",{className:"shell-icon-button"},s.a.Search),this.state.dynamicsDisplayStack.map(function(e){return o.createElement("button",{key:e.label,className:"shell-icon-button"},e.icon)}),this.getOverflowItems(this.state).length>1?o.createElement("button",{onClick:this.toggleOverflowMenu,className:"shell-icon-button shell-icon-button--more"},s.a.More,this.state.showOverflowMenu?o.createElement("div",{className:"overflow-menu"},this.state.dynamicsOverflowStack.concat(this.state.customOverflowStack).map(function(e){return o.createElement("div",{key:e.label,className:"menu-row"},o.createElement("span",{className:"menu-row__icon"},e.icon),o.createElement("span",{className:"menu-row__text"},e.label))}),this.state.systemOverflowStack.length?o.createElement("div",{className:"menu-divider"}):null,this.state.systemOverflowStack.map(function(e){return o.createElement("div",{key:e.label,className:"menu-row"},o.createElement("span",{className:"menu-row__icon"},e.icon),o.createElement("span",{className:"menu-row__text"},e.label))})):null):this.getOverflowItems(this.state).length>0?o.createElement("button",{className:"shell-icon-button"},this.state.customOverflowStack[0].icon):null,this.state.systemDisplayStack.length?o.createElement("div",{className:"shell-divider"}):null,this.state.systemDisplayStack.map(function(e){return o.createElement("button",{key:e.label,className:"shell-icon-button"},e.icon)}),o.createElement("button",{className:"shell-icon-button shell-icon-button--avatar"},o.createElement("img",{className:"avatar",alt:"your avatar",src:this.props.avatarImgUrl})))},t}(o.Component),u=i.a.header(l||(l=c(["\n  color: white;\n  display: flex;\n  align-items: center;\n  height: ","px;\n  background-color: #002050;\n\n  .overflow-menu {\n    background-color: white;\n    color: black;\n    font-family: var(--ff-segoe-ui);\n    position: absolute;\n    top: ","px;\n    right: 0;\n    box-shadow: 0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108);\n  }\n\n  .menu-row__text {\n    white-space: nowrap;\n  }\n\n  .menu-row {\n    display: flex;\n    margin: 16px 16px;\n    align-items: center;\n  }\n\n  .menu-row__icon {\n    font-family: var(--ff-mdl2);\n    flex: 0 0 16px;\n    margin-right: 16px;\n  }\n\n  .menu-divider {\n    height: 1px;\n    background-color: rgba(0, 0, 0, 0.25);\n  }\n\n  .shell-divider {\n    align-self: stretch;\n    margin: ","px ","px;\n    width: ","px;\n    flex: 0 0 auto;\n    background-color: rgba(255, 255, 255, 0.55);\n  }\n\n  .shell-title {\n    flex: 1 1 auto;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    font-weight: 600;\n  }\n\n  .shell-icon-button {\n    background-color: transparent;\n    flex: 0 0 auto;\n    color: white;\n    border: none;\n    font-size: 16px;\n    font-family: var(--ff-mdl2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: ","px;\n    width: ","px;\n  }\n\n  .shell-icon-button--avatar {\n    height: ","px;\n    width: ","px;\n    box-sizing: border-box;\n\n    .avatar {\n      border-radius: 50%;\n      height: calc(0.6 * ","px);\n      width: calc(0.6 * ","px);\n      box-sizing: border-box;\n    }\n  }\n\n  .shell-icon-button--more {\n    position: relative;\n  }\n"],["\n  color: white;\n  display: flex;\n  align-items: center;\n  height: ","px;\n  background-color: #002050;\n\n  .overflow-menu {\n    background-color: white;\n    color: black;\n    font-family: var(--ff-segoe-ui);\n    position: absolute;\n    top: ","px;\n    right: 0;\n    box-shadow: 0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108);\n  }\n\n  .menu-row__text {\n    white-space: nowrap;\n  }\n\n  .menu-row {\n    display: flex;\n    margin: 16px 16px;\n    align-items: center;\n  }\n\n  .menu-row__icon {\n    font-family: var(--ff-mdl2);\n    flex: 0 0 16px;\n    margin-right: 16px;\n  }\n\n  .menu-divider {\n    height: 1px;\n    background-color: rgba(0, 0, 0, 0.25);\n  }\n\n  .shell-divider {\n    align-self: stretch;\n    margin: ","px ","px;\n    width: ","px;\n    flex: 0 0 auto;\n    background-color: rgba(255, 255, 255, 0.55);\n  }\n\n  .shell-title {\n    flex: 1 1 auto;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    font-weight: 600;\n  }\n\n  .shell-icon-button {\n    background-color: transparent;\n    flex: 0 0 auto;\n    color: white;\n    border: none;\n    font-size: 16px;\n    font-family: var(--ff-mdl2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: ","px;\n    width: ","px;\n  }\n\n  .shell-icon-button--avatar {\n    height: ","px;\n    width: ","px;\n    box-sizing: border-box;\n\n    .avatar {\n      border-radius: 50%;\n      height: calc(0.6 * ","px);\n      width: calc(0.6 * ","px);\n      box-sizing: border-box;\n    }\n  }\n\n  .shell-icon-button--more {\n    position: relative;\n  }\n"])),m.shellHeight,m.shellHeight,m.shellDividerVerticalMargin,m.shellDividerSideMargin,m.dividerStrokeWidth,m.shellHeight,m.shellHeight,m.shellHeight,m.shellHeight,m.shellHeight,m.shellHeight)},50:function(e,t,n){"use strict";n.r(t),n.d(t,"appShellDemoProps",function(){return c}),n.d(t,"AppShellDemo",function(){return m});var a,l=n(0),o=n(36),i=n(49),s=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},c={avatarImgUrl:"https://api.adorable.io/avatars/285/abott@adorable.png",dynamicsDisplayStack:[{icon:o.a.TBX,label:"Task flow"},{icon:o.a.ToolTip,label:"Relationship Assistant"},{icon:o.a.Add,label:"Create"}],systemDisplayStack:[{icon:o.a.Settings,label:"Settings"},{icon:o.a.Help,label:"Help"}],customOverflowStack:[{icon:o.a.Emoji2,label:"Custom 0"}]},m=function(e){function t(t){var n=e.call(this,t)||this;return n.addCustomItem=function(){var e=n.state.customOverflowStack.concat([{icon:o.a.Emoji2,label:"Custom "+n.state.customOverflowStack.length}]);n.setState({customOverflowStack:e})},n.removeCustomItem=function(){var e=n.state.customOverflowStack.slice();e.pop(),n.setState({customOverflowStack:e})},n.state=c,n}return s(t,e),t.prototype.render=function(){return l.createElement(l.Fragment,null,l.createElement("section",null,l.createElement("h2",{className:"lab-demo-h2"},"Sample"),l.createElement(i.a,r({},this.state))),l.createElement("section",null,l.createElement("h2",{className:"lab-demo-h2"},"Usage"),l.createElement("section",{style:{marginTop:"16px"}},l.createElement("span",null,"Custom actions: "),l.createElement("button",{onClick:this.removeCustomItem},"-"),l.createElement("span",null," ",this.state.customOverflowStack.length," "),l.createElement("button",{onClick:this.addCustomItem},"+")),l.createElement("section",null,l.createElement("h3",null,"Design notes"),l.createElement("ul",null,l.createElement("li",null,"This prototype only shows browser behavior. Shim experience is out of scope"),l.createElement("li",null,"When viewport narrows, Dynamics actions (task flow, relationship assistance, create) collapse first, then System buttons (help, settings) next"),l.createElement("li",null,"Custom actions are always collapsed except when there is only one"),l.createElement("li",null,"The System buttons are either all collapsed or all expanded"),l.createElement("li",null,"The Dynamics actions are either all collapsed or all expanded")))))},t}(l.Component);t.default=m}}]);